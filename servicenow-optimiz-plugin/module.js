/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","@grafana/runtime","lodash"],(function(e,t,n,a,r){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=53)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t){e.exports=r},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){var a=n(11),r=n(30),l=n(31),i=a?a.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?r(e):l(e)}},function(e,t,n){var a=n(12),r="object"==typeof self&&self&&self.Object===Object&&self,l=a||r||Function("return this")();e.exports=l},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var a=n(6),r=n(5);e.exports=function(e){if(!r(e))return!1;var t=a(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var a=n(7).Symbol;e.exports=a},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(29))},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var a=n(10),r=n(15);e.exports=function(e){return null!=e&&r(e.length)&&!a(e)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var a=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==a||"symbol"!=a&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var a=n(20),r=n(13),l=n(37),i=n(38),o=Object.prototype,u=o.hasOwnProperty,s=a((function(e,t){e=Object(e);var n=-1,a=t.length,s=a>2?t[2]:void 0;for(s&&l(t[0],t[1],s)&&(a=1);++n<a;)for(var c=t[n],p=i(c),d=-1,m=p.length;++d<m;){var f=p[d],y=e[f];(void 0===y||r(y,o[f])&&!u.call(e,f))&&(e[f]=c[f])}return e}));e.exports=s},function(e,t,n){"use strict";function a(){var e=Object.create(null),t=0,n=0,a=0,r=!1;function l(t){a--,delete e[t]}this.put=function(t,n,r,i){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==i&&"function"!=typeof i)throw new Error("Cache timeout callback must be a function");var o=e[t];o?clearTimeout(o.timeout):a++;var u={value:n,expire:r+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){l(t),i&&i(t,n)}.bind(this),r)),e[t]=u,n},this.del=function(t){var n=!0,a=e[t];return a?(clearTimeout(a.timeout),!isNaN(a.expire)&&a.expire<Date.now()&&(n=!1)):n=!1,n&&l(t),n},this.clear=function(){for(var l in e)clearTimeout(e[l].timeout);a=0,e=Object.create(null),r&&(t=0,n=0)},this.get=function(l){var i=e[l];if(void 0!==i){if(isNaN(i.expire)||i.expire>=Date.now())return r&&t++,i.value;r&&n++,a--,delete e[l]}else r&&n++;return null},this.size=function(){return a},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var a=e[n];t[n]={value:a.value,expire:a.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var a=JSON.parse(t),r=Date.now(),l=n&&n.skipDuplicates;for(var i in a)if(a.hasOwnProperty(i)){if(l)if(e[i])continue;var o=a[i],u=o.expire-r;if(u<=0){this.del(i);continue}u=u>0?u:void 0,this.put(i,o.value,u)}return this.size()}}e.exports=new a,e.exports.Cache=a},function(e,t,n){var a=n(9),r=n(21),l=n(23);e.exports=function(e,t){return l(r(e,t,a),e+"")}},function(e,t,n){var a=n(22),r=Math.max;e.exports=function(e,t,n){return t=r(void 0===t?e.length-1:t,0),function(){for(var l=arguments,i=-1,o=r(l.length-t,0),u=Array(o);++i<o;)u[i]=l[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=l[i];return s[t]=n(u),a(e,this,s)}}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var a=n(24),r=n(36)(a);e.exports=r},function(e,t,n){var a=n(25),r=n(26),l=n(9),i=r?function(e,t){return r(e,"toString",{configurable:!0,enumerable:!1,value:a(t),writable:!0})}:l;e.exports=i},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var a=n(27),r=function(){try{var e=a(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=r},function(e,t,n){var a=n(28),r=n(35);e.exports=function(e,t){var n=r(e,t);return a(n)?n:void 0}},function(e,t,n){var a=n(10),r=n(32),l=n(5),i=n(34),o=/^\[object .+?Constructor\]$/,u=Function.prototype,s=Object.prototype,c=u.toString,p=s.hasOwnProperty,d=RegExp("^"+c.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!l(e)||r(e))&&(a(e)?d:o).test(i(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var a=n(11),r=Object.prototype,l=r.hasOwnProperty,i=r.toString,o=a?a.toStringTag:void 0;e.exports=function(e){var t=l.call(e,o),n=e[o];try{e[o]=void 0;var a=!0}catch(e){}var r=i.call(e);return a&&(t?e[o]=n:delete e[o]),r}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var a,r=n(33),l=(a=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"";e.exports=function(e){return!!l&&l in e}},function(e,t,n){var a=n(7)["__core-js_shared__"];e.exports=a},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){var n=Date.now;e.exports=function(e){var t=0,a=0;return function(){var r=n(),l=16-(r-a);if(a=r,l>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var a=n(13),r=n(14),l=n(16),i=n(5);e.exports=function(e,t,n){if(!i(n))return!1;var o=typeof t;return!!("number"==o?r(n)&&l(t,n.length):"string"==o&&t in n)&&a(n[t],e)}},function(e,t,n){var a=n(39),r=n(50),l=n(14);e.exports=function(e){return l(e)?a(e,!0):r(e)}},function(e,t,n){var a=n(40),r=n(41),l=n(43),i=n(44),o=n(16),u=n(46),s=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=l(e),c=!n&&r(e),p=!n&&!c&&i(e),d=!n&&!c&&!p&&u(e),m=n||c||p||d,f=m?a(e.length,String):[],y=f.length;for(var v in e)!t&&!s.call(e,v)||m&&("length"==v||p&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||o(v,y))||f.push(v);return f}},function(e,t){e.exports=function(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a}},function(e,t,n){var a=n(42),r=n(8),l=Object.prototype,i=l.hasOwnProperty,o=l.propertyIsEnumerable,u=a(function(){return arguments}())?a:function(e){return r(e)&&i.call(e,"callee")&&!o.call(e,"callee")};e.exports=u},function(e,t,n){var a=n(6),r=n(8);e.exports=function(e){return r(e)&&"[object Arguments]"==a(e)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){(function(e){var a=n(7),r=n(45),l=t&&!t.nodeType&&t,i=l&&"object"==typeof e&&e&&!e.nodeType&&e,o=i&&i.exports===l?a.Buffer:void 0,u=(o?o.isBuffer:void 0)||r;e.exports=u}).call(this,n(17)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,n){var a=n(47),r=n(48),l=n(49),i=l&&l.isTypedArray,o=i?r(i):a;e.exports=o},function(e,t,n){var a=n(6),r=n(15),l=n(8),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,e.exports=function(e){return l(e)&&r(e.length)&&!!i[a(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var a=n(12),r=t&&!t.nodeType&&t,l=r&&"object"==typeof e&&e&&!e.nodeType&&e,i=l&&l.exports===r&&a.process,o=function(){try{var e=l&&l.require&&l.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o}).call(this,n(17)(e))},function(e,t,n){var a=n(5),r=n(51),l=n(52),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!a(e))return l(e);var t=r(e),n=[];for(var o in e)("constructor"!=o||!t&&i.call(e,o))&&n.push(o);return n}},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){"use strict";n.r(t);var a=n(2),r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function l(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function o(e,t,n,a){return new(n||(n=Promise))((function(r,l){function i(e){try{u(a.next(e))}catch(e){l(e)}}function o(e){try{u(a.throw(e))}catch(e){l(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}u((a=a.apply(e,t||[])).next())}))}function u(e,t){var n,a,r,l,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function o(l){return function(o){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&l[0]?a.return:l[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,l[1])).done)return r;switch(a=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,a=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){i.label=l[1];break}if(6===l[0]&&i.label<r[1]){i.label=r[1],r=l;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(l);break}r[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],a=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,o])}}}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,r,l=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=l.next()).done;)i.push(a.value)}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return i}var c=n(18),p=n.n(c),d=n(3),m=n(4),f=n.n(m),y={selectedQueryCategory:{label:"Metrics",value:"Metrics",description:"Get Timeseries metrics."}},v=n(19),h=n.n(v),g=["sys_created_on"];function b(e,t){var n=Object(d.getTemplateSrv)().replace(e,t,"csv"),a=n.indexOf(",");if(a>=0){for(;a>=0;)a=(n=n.replace(",","|")).indexOf(",");n="("+n+")"}return n.startsWith("(")&&n.endsWith(")")?"/"+n+"/":n}function C(e,t){return Object(d.getTemplateSrv)().replace(e,t,"csv")}function T(e){1}function w(e){return")"===e.charAt(e.length-2)&&"("===e.charAt(1)&&(e=e.charAt(0)+e.slice(2,-2)+e.charAt(e.length-1)),e}function E(e){var t="";if(1===e.length)return e[0];if("string"==typeof e)return e;for(var n=0;n<e.length;n++)t+="|"+e[n];return"|"===t.charAt(0)&&(t="/"+(t=t.substring(1,t.length))+"/"),t}var O,S=n(4),_=(O=S)&&O.__esModule?O:{default:O};var V=function(){function e(e,t,n){this.requestOptions={headers:e,withCredentials:t,url:n},this.cache=new h.a.Cache}return e.prototype.cachedGet=function(e,t,n,a,r,l,i){return o(this,void 0,void 0,(function(){var t,r,o,c,p=this;return u(this,(function(u){return e?(t=this.requestOptions.url+n,r=t+="/body/"+l,a&&Object.keys(a).length>0&&(t=t+(t.search(/\?/)>=0?"&":"?")+a.map((function(e){var t=s(e,2),n=t[0],a=t[1];return encodeURIComponent(n)+"="+encodeURIComponent(a)})).join("&")),this.lastCacheDuration!==e&&this.cache.del(t),this.lastCacheDuration=e,(o=this.cache.get(t))||this.cache.keys().map((function(e){if(e.includes(r)){var n=e.substring(e.indexOf("?")+1,e.length),a=(n=n.split("&"))[0].substring(n[0].indexOf("=")+1,n[0].length),l=n[1].substring(n[1].indexOf("=")+1,n[1].length),i=t.substring(t.indexOf("?")+1,t.length),u=(i=i.split("&"))[0].substring(i[0].indexOf("=")+1,i[0].length),s=i[1].substring(i[1].indexOf("=")+1,i[1].length);u-a<=6e4&&s-l<=6e4&&(o=p.cache.get(e))}})),o?[2,Promise.resolve(o)]:(c=Object(d.getBackendSrv)().datasourceRequest(i),this.cache.put(t,c,1e3*e),[2,c])):[2,Object(d.getBackendSrv)().datasourceRequest(i)]}))}))},e.prototype.request=function(e){e.withCredentials=this.requestOptions.withCredentials,e.headers=this.requestOptions.headers;var t=e.url;e.url=this.requestOptions.url+t;var n=t.indexOf("?");-1===n&&(n=t.length);var a=t.substring(0,n),r=[];-1!==e.url.indexOf("?")&&e.url.substring(e.url.indexOf("?")+1,e.url.length).split("&").map((function(e){var t=[e.substring(0,e.indexOf("=")),e.substring(e.indexOf("=")+1,e.length)];r.push(t)}));return this.cachedGet(60,e.method,a,r,e.headers,e.data,e)},e.prototype.mapChecksToValue=function(e){return _.default.map(e.data,(function(e,t){return{text:e.name,value:e.id}}))},e.prototype.mapToTextValue=function(e){return _.default.map(e.data,(function(e,t){return e&&e.text&&e.value?{text:e.text,value:e.value}:_.default.isObject(e)?{text:e,value:t}:{text:e,value:e}}))},e.prototype.mapMetricsResponseToFrame=function(e,t){return e.data.map((function(e){var n=e.source+":"+e.metricName;return e.type.length>0&&(n+=":"+e.type),function(e,t,n,r,l){var i,o={name:a.TIME_SERIES_TIME_FIELD_NAME,type:a.FieldType.time,config:{custom:{}},values:new a.ArrayVector(e.map((function(e){return e[1]})))};i=(a.FieldType.string,new a.ArrayVector(e.map((function(e){return e[0]}))));var u=[o,{name:a.TIME_SERIES_VALUE_FIELD_NAME,type:null!=l?l:a.FieldType.number,labels:{},config:{displayName:t,custom:{}},values:i}];return{name:t,refId:n.refId,fields:u,length:e.length}}(e.datapoints,n,t,0,a.FieldType.number)}))},e.prototype.mapAnamMetricsResponseToFrame=function(e,t,n){return e.data.map((function(e){var r=b(t.source,n.scopedVars),l=b(t.metricType,n.scopedVars),i=r+":"+b(t.metricName,n.scopedVars)+":"+l+":"+e.type;return"UPPER"!==e.type&&"LOWER"!==e.type||(i=e.type),function(e,t,n,r,l){var i,o={name:a.TIME_SERIES_TIME_FIELD_NAME,type:a.FieldType.time,config:{custom:{}},values:new a.ArrayVector(e.map((function(e){return e.x})))};i=(a.FieldType.string,new a.ArrayVector(e.map((function(e){return e.y}))));var u=[o,{name:a.TIME_SERIES_VALUE_FIELD_NAME,type:null!=l?l:a.FieldType.number,labels:{},config:{displayName:t,custom:{}},values:i}];return{name:t,refId:n.refId,fields:u,length:e.length}}(e.data,i,t,0,a.FieldType.number)}))},e.prototype.mapTextResponseToFrame=function(e){var t=new a.MutableDataFrame({fields:[]});if(T(),!(e.data.length>0))return[];for(var n,r,l=Object.keys(e.data[0]),i=0;i<l.length;i++){var o=e.data.map((function(e){return e[l[i]]}));"new"===l[i]&&(o=this.sanitizeValues(o));var u=a.FieldType.string;o.length>=0&&(n=o[0],r=l[i],u=g.includes(r)?a.FieldType.time:"number"==typeof n?a.FieldType.number:a.FieldType.string),t.addField({name:l[i],type:u,values:o})}return T(),t},e.prototype.sanitizeValues=function(e){var t=[];return e.map((function(e){for(;-1!==e.indexOf("[code]");){var n=e.substring(0,e.indexOf("[code]")),a=e.substring(e.indexOf("[/code]")+7,e.length);if(-1!==e.indexOf("<a")){var r=e.substring(e.indexOf("<a"),e.indexOf("</a>",e.indexOf("<a"))),l=r.substring(r.indexOf(">")+1,r.length);-1!==l.indexOf("<")&&(l=l.substring(0,l.indexOf("<"))),e=n+l+a}else e=n+a}t.push(e)})),t},e}();function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var A=function(){function e(e){var t=e.basicAuth,n=e.withCredentials,a=e.url;this.apiPath="";var r={"Content-Type":"application/json"};"string"==typeof t&&t.length>0&&(r.Authorization=t),this.apiClient=new V(r,n,a)}return e.prototype.getLiveACCData=function(e,t){void 0!==e.live_osquery&&C(e.live_osquery,t.scopedVars);return this.apiClient.mapTextResponseToFrame({data:[{mem_in_megs:"740.39",name:"nscd",pid:"689"},{mem_in_megs:"333.76",name:"rsyslogd",pid:"29468"},{mem_in_megs:"125.67",name:"acc",pid:"30448"},{mem_in_megs:"109.54",name:"lvmetad",pid:"13729"},{mem_in_megs:"78.15",name:"xenstore-watch",pid:"707"}]})},e.prototype.getCIs=function(e,t){var n,a=this.apiPath+"/searchV2",r=t;return""!==t&&(a=this.apiPath+"/search/cisV2"),n='{"targets":[{"target":"'+r+'","sysparm_query":"'+e+'"}]}',this.apiClient.request({url:a,data:n,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getNestedCIS=function(e){var t='{"targets":[{"ci": "'+e.ci+'",\n      "parentDepth":"'+e.parentDepth+'",\n      "childDepth":"'+e.childDepth+'",\n      "namespaces":"'+e.namespaces+'",\n      "excludedClasses":"'+e.excludeClasses+'",\n      "dependsOn":"'+e.dependsOn+'",\n      "type":"ci"}]}';return this.apiClient.request({url:this.apiPath+"/v2/variable/nested_value",data:t,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getNestedClasses=function(e){var t='{"targets":[{"ci": "'+e.ci+'",\n      "parentDepth":"'+e.parentDepth+'",\n      "childDepth":"'+e.childDepth+'",\n      "namespaces":"'+e.namespaces+'",\n      "excludedClasses":"'+e.excludeClasses+'",\n      "dependsOn":"'+e.dependsOn+'",\n      "type":"class"}]}';return this.apiClient.request({url:this.apiPath+"/v2/variable/nested_value",data:t,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getApplicationServices=function(e){var t='{"targets":[{"sysparm_query":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/search/app_services",data:t,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getGenericVariable=function(e,t,n,a){var r='{"targets":[{"tableName":"'+e+'","nameColumn":"'+t+'","idColumn":"'+n+'","sysparm":"'+a+'"}]}';return this.apiClient.request({url:this.apiPath+"/v2/variable/generic",data:r,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getAWSRegions=function(){return this.apiClient.request({url:this.apiPath+"/v2/variable/aws_regions",method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getKubernetesNamespaces=function(){return this.apiClient.request({url:this.apiPath+"/v2/variable/kubernetes_namespaces",method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getServices=function(e){var t='{"targets":[{"filter":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/search/servicesV2",data:t,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getMetricsFrames=function(e,t,n,a){return this.getMetrics(e,t,n,a)},e.prototype.getMetrics=function(e,t,n,a){var r=this;var l=!1,i="",o=[],u="",s=[],c="",p="";void 0!==e.selectedSourceList&&(i=b(e.selectedSourceList.value,a.scopedVars)),void 0!==e.selectedMetricTypeList&&(e.selectedMetricTypeList.map((function(e){o.push(b(e.value,a.scopedVars))})),u=E(o)),void 0!==e.selectedMetricNameList&&(e.selectedMetricNameList.length>=1?(e.selectedMetricNameList.map((function(e){s.push(b(e.value,a.scopedVars))})),c=E(s)):c=b(e.selectedMetricNameList.value,a.scopedVars)),void 0!==e.selectedMetricAnomalyList&&"true"===b(e.selectedMetricAnomalyList.value,a.scopedVars)&&(l=!0),void 0!==e.sysparam_query&&(p=C(e.sysparam_query,a.scopedVars)),c=w(c);var d='{"targets":[{"target":"'+(i=w(i))+'","resourceName":"'+u+'","metricName":"'+c+'","sysparm_query":"'+p+'"}]}',m=this.apiPath+"/query/ci_single_metricV2?startTime="+t+"&endTime="+n;return"*"===c&&(m=this.apiPath+"/query/metricsV2?startTime="+t+"&endTime="+n),!0===l&&(m=this.apiPath+"/query/metrics/anomalityV2?startTime="+t+"&endTime="+n),this.apiClient.request({url:m,data:d,method:"POST"}).then((function(t){return!0===l?r.apiClient.mapAnamMetricsResponseToFrame(t,e,a):r.apiClient.mapMetricsResponseToFrame(t,e)}))},e.prototype.getTextFrames=function(e,t,n,a,r){return"Alerts"===r?this.getAlerts(e,t,n,a):"Changes"===r?this.getChanges(e,t,n,a):"CI_Summary"===r?this.getCISummary(e,a):"Agents"===r?this.getAllACCAgents(e,t,n,a):"Admin"===r?"Metrics Definition"===e.selectedAdminCategoryList.value?this.getMetricsDefinition(e,t,n,a):[]:"Generic"===r?this.queryGenericTable(e,t,n,a):"Database_Views"===r?this.queryDatabaseViews(e,t,n,a):[]},e.prototype.getGeohashMap=function(e,t){var n=this,a="",r="",l="";void 0!==e.tableName&&""!==e.tableName&&(a=b(e.tableName,t.scopedVars)),void 0!==e.groupBy&&""!==e.groupBy&&(r=e.groupBy),void 0!==e.sysparam_query&&""!==e.sysparam_query&&(l=C(e.sysparam_query,t.scopedVars));var i='{"targets":[{"target":"'+a+'","column":"'+r+'","sysparm":"'+l+'"}]}';return this.apiClient.request({url:this.apiPath+"/v2/query/geohash_map",data:i,method:"POST"}).then((function(e){return T(),T(),n.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getAggregateQuery=function(e,t){var n=this,a="",r="",l="",i="",o="";void 0!==e.tableName&&""!==e.tableName&&(a=b(e.tableName,t.scopedVars)),void 0!==e.groupBy&&""!==e.groupBy&&(r=e.groupBy),void 0!==e.selectedAggregateType&&""!==e.selectedAggregateType.value&&(l=e.selectedAggregateType.value),void 0!==e.aggregateColumn&&""!==e.aggregateColumn&&(i=e.aggregateColumn),void 0!==e.sysparam_query&&""!==e.sysparam_query&&(o=C(e.sysparam_query,t.scopedVars));var u='{"targets":[{"target":"'+a+'","type":"'+l+'","column":"'+i+'","groupBy":"'+r+'","sysparm":"'+o+'"}]}';return this.apiClient.request({url:this.apiPath+"/v2/query/aggregate",data:u,method:"POST"}).then((function(e){return T(),T(),n.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getRowCount=function(e,t){var n=this,a="";void 0!==e.tableName&&""!==e.tableName&&(a=b(e.tableName,t.scopedVars));var r="";void 0!==e.sysparam_query&&""!==e.sysparam_query&&(r=C(e.sysparam_query,t.scopedVars));var l='{"targets":[{"target":"'+a+'","sysparm":"'+r+'"}]}';return this.apiClient.request({url:this.apiPath+"/v2/query/row_count",data:l,method:"POST"}).then((function(e){return T(),T(),n.apiClient.mapTextResponseToFrame(e)}))},e.prototype.queryDatabaseViews=function(e,t,n,a){var r=this,l="";void 0!==e.tableName&&""!==e.tableName&&(l=b(e.tableName,a.scopedVars));var i="";void 0!==e.tableColumns&&""!==e.tableColumns&&(i=b(e.tableColumns,a.scopedVars));var o="";void 0!==e.sysparam_query&&""!==e.sysparam_query&&(o=C(e.sysparam_query,a.scopedVars));var u='{"targets":[{"target":"'+l+'","columns":"'+i+'","sysparm":"'+o+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/dbview",data:u,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.queryGenericTable=function(e,t,n,a){var r=this;var l="";void 0!==e.tableName&&""!==e.tableName&&(l=b(e.tableName,a.scopedVars));var i="";void 0!==e.sysparam_query&&""!==e.sysparam_query&&(i=b(e.sysparam_query,a.scopedVars)),0===i.indexOf("/")&&(i=(i=i.substring(2,i.length-2)).replace(/[|]/g,","));var o='{"targets":[{"target":"'+l+'","sysparm":"'+i+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/table",data:o,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getTopologyFrame=function(e,t,n,a){return this.getTopology(e,t,n,a).then((function(t){var n=[{columns:[{text:"type"},{type:"time",text:"Time"},{text:"app"},{text:"target_app"},{text:"req_rate"},{text:"error_rate"}],rows:t,refId:e.refId||void 0,meta:void 0}];return T(),{data:n}}))},e.prototype.getTopology=function(e,t,n,a){var r=b(e.service,a.scopedVars);void 0!==e.selectedServiceList&&(r=b(e.selectedServiceList.value,a.scopedVars));var l="";void 0!==e.topology_child_depth&&(l=b(e.topology_child_depth,a.scopedVars));var i="";void 0!==e.topology_parent_depth&&(i=b(e.topology_parent_depth,a.scopedVars));var o="";void 0!==e.topology_filter&&e.topology_filter&&(o=b(e.topology_filter,a.scopedVars));var u="";void 0!==e.topology_namespaces&&e.topology_namespaces&&(u=b(e.topology_namespaces,a.scopedVars));var s="";void 0!==e.sysparam_query&&""!==e.sysparam_query&&(s=b(e.sysparam_query,a.scopedVars));var c="";void 0!==e.selectedTopologyDependsOnFilter&&(c=b(e.selectedTopologyDependsOnFilter.value,a.scopedVars));var p='{"targets":[{"target":"'+r+'","child_depth":"'+l+'","parent_depth":"'+i+'","exclude_classes":"'+o+'","sysparm_query":"'+s+'","namespaces":"'+u+'","dependsOn":"'+c+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/topology",data:p,method:"POST"}).then((function(e){return T(),T(),T(),T(e.data),T(),e.data.rows}))},e.prototype.getMetricsDefinition=function(e,t,n,a){var r=this;var l='{"targets":[{"target":"'+b(e.sysparam_query,a.scopedVars)+'","metricName":""}]}';return this.apiClient.request({url:this.apiPath+"/query/metrics_mapping?startTime="+t+"&endTime="+n,data:l,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getMetricNamesInCIs=function(e,t){var n=E(t),a='{"targets":[{"target":"'+(n=w(n))+'","metricType":"'+e+'"}]}',r=this.apiPath+"/query/cis/metricsV2";return this.apiClient.request({url:r,data:a,method:"POST"}).then(this.apiClient.mapChecksToValue)},e.prototype.getAlerts=function(e,t,n,a){var r=this;var l=b(e.service,a.scopedVars),i=b(e.source,a.scopedVars),o=l,u="Active",s="service",c="";void 0!==e.selectedAlertStateList&&(u=e.selectedAlertStateList.value),e.selectedAlertTypeList&&("CI"===e.selectedAlertTypeList.value?(s="ci",o=i):"OS"===e.selectedAlertTypeList.value?(s="os",-1!==(o=i).indexOf("(")&&(o=o.substring(o.indexOf("(")+1,o.indexOf(")")))):"None"===e.selectedAlertTypeList.value&&(s="none")),void 0!==e.sysparam_query&&e.sysparam_query&&(c=C(e.sysparam_query,a.scopedVars));var p='{"targets":[{"target":"'+o+'","sysparm_query":"'+c+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/alertsV2?startTime="+ +t+"&endTime="+n+"&alertState="+u+"&alertType="+s,data:p,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getChanges=function(e,t,n,a){var r=this;var l="$service";e.selectedServiceList&&(l=e.selectedServiceList.value);var i=b(l,a.scopedVars),o=b(e.source,a.scopedVars),u=i,s="service",c="";e.selectedChangeTypeList&&"CI"===e.selectedChangeTypeList.value&&(s="ci",u=o),void 0!==e.sysparam_query&&e.sysparam_query&&(c=b(e.sysparam_query,a.scopedVars));var p='{"targets":[{"target":"'+u+'","sysparm_query":"'+c+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/changeV2?startTime="+t+"&endTime="+n+"&alertType="+s,data:p,method:"POST"}).then((function(e){return T(),T(),r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getAllACCAgents=function(e,t,n,a){var r=this;var l="",i=[],o="",u="",s="";void 0!==e.selectedAgentFilter&&e.selectedAgentFilter.value&&(l=b(e.selectedAgentFilter.value,a.scopedVars)),void 0!==e.selectedMetricNameList&&(e.selectedMetricNameList.map((function(e){i.push(b(e.value,a.scopedVars))})),o=E(i)),F(e.sysparam_query)&&e.sysparam_query&&(u=b(e.sysparam_query,a.scopedVars)),void 0!==e.selectedAgentFilterType&&e.selectedAgentFilterType&&(s=e.selectedAgentFilterType.value.toLowerCase());var c='{"targets":[{"target":"'+l+'","metricName":"'+o+'","sysparm_query":"'+u+'","filterType":"'+s+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/acc_agentsV2?startTime="+t+"&endTime="+n,data:c,method:"POST"}).then((function(e){return r.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getTopologyCISummary=function(e){var t='{"targets":[{"target":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/query/ci_summary",data:t,method:"POST"}).then((function(e){return T(),T(),e.data}))},e.prototype.getCISummary=function(e,t){var n=this,a=b(e.source,t.scopedVars),r="";void 0!==e.sysparam_query&&e.sysparam_query&&(r=b(e.sysparam_query,t.scopedVars));var l='{"targets":[{"target":"'+a+'","sysparm_query":"'+r+'"}]}';return this.apiClient.request({url:this.apiPath+"/search/ci/summaryTblV2",data:l,method:"POST"}).then((function(e){return T(),T(),n.apiClient.mapTextResponseToFrame(e)}))},e.prototype.getMetricAnomalyOptions=function(){return[{label:"true",value:"true"},{label:"false",value:"false"}]},e.prototype.getAggregateTypeOptions=function(){return[{label:"AVG",value:"AVG"},{label:"COUNT",value:"COUNT"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"STDDEV",value:"STDDEV"},{label:"SUM",value:"SUM"}]},e.prototype.getAlertStateOptions=function(){return[{label:"Active",value:"Active",description:"Get Open and Reopen Alerts"},{label:"All",value:"All",description:"Get All alerts Open,Reopen, and Closed"}]},e.prototype.getAlertTypeOptions=function(){return[{label:"CI",value:"CI",description:"Get Alerts at the CI level"},{label:"Service",value:"Service",description:"Get Alerts at the Service level"},{label:"OS",value:"OS",description:"Get Alerts for all Agents in the class"},{label:"None",value:"None",description:"Ignore CI selection and use sysparam_query"}]},e.prototype.getAgentFilterTypeOptions=function(){return[{label:"OS",value:"OS",description:"Get all agents matching the OS"},{label:"CI",value:"CI",description:"Get all agents matching the CI"}]},e.prototype.getChangeTypeOptions=function(){return[{label:"CI",value:"CI",description:"Get Changes at the CI level"},{label:"Service",value:"Service",description:"Get Changes at the Service level"}]},e.prototype.getAdminQueryOptions=function(){return[{label:"Metrics Definition",value:"Metrics Definition",description:""}]},e.prototype.getAgentMetricOptions=function(){return[{label:"cpu",value:"cpu"},{label:"memory",value:"memory"},{label:"disk",value:"disk"}]},e.prototype.getAgentFilters=function(){return o(this,void 0,void 0,(function(){var e,t;return u(this,(function(n){switch(n.label){case 0:return[4,this.getMonitoredCIsClasses("")];case 1:return e=n.sent(),t=[],e.map((function(e){t.push({label:e.text,value:e.value,description:""})})),[2,t]}}))}))},e.prototype.getMonitoredCIsClasses=function(e){var t='{"targets":[{"sysparm":"'+e+'"}]}';return this.apiClient.request({url:this.apiPath+"/search/cis/classV2",data:t,method:"POST"}).then(this.apiClient.mapChecksToValue)},e}(),x=function(e){function t(t){var n=e.call(this,t)||this,a={type:t.type,url:t.url,name:t.name,basicAuth:t.basicAuth,withCredentials:t.withCredentials};return n.snowConnection=new A(a),n.annotations={},n}return l(t,e),t.prototype.metricFindQuery=function(e,t){return o(this,void 0,void 0,(function(){var n,a,r,l,i,o,s,c,p,m,f,y;return u(this,(function(u){return"services"===e.namespace?(a=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),[2,this.snowConnection.getServices(a)]):"application_services"===e.namespace?(a="",e.rawQuery&&(a=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv")),[2,this.snowConnection.getApplicationServices(a)]):"cis"===e.namespace?(a=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),[2,this.snowConnection.getCIs("",a)]):"cis_sysquery"===e.namespace?(n=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),[2,this.snowConnection.getCIs(n,"")]):"classes"===e.namespace?(a="",e.rawQuery&&(a=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv")),[2,this.snowConnection.getMonitoredCIsClasses(a)]):(e.namespace,"metric_names"===e.namespace?(a=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),r=a.split(","),[2,this.snowConnection.getMetricNamesInCIs("",r)]):"golden_metric_names"===e.namespace?(a=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),r=a.split(","),[2,this.snowConnection.getMetricNamesInCIs("GOLDEN",r)]):"custom_kpis"===e.namespace?(a=Object(d.getTemplateSrv)().replace(e.rawQuery,t.scopedVars,"csv"),r=a.split(","),[2,this.snowConnection.getMetricNamesInCIs("CUSTOM_KPIS",r)]):"nested_cis"===e.namespace?((l=e.rawQuery.split("||")).map((function(e,n){l[n]=Object(d.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===l[n].indexOf("$")&&(l=l.splice(n))})),i={ci:l[0],parentDepth:l[1],childDepth:l[2],namespaces:l[3],excludeClasses:l[4],dependsOn:l[5]},[2,this.snowConnection.getNestedCIS(i)]):"nested_classes"===e.namespace?((o=e.rawQuery.split("||")).map((function(e,n){o[n]=Object(d.getTemplateSrv)().replace(e,t.scopedVars,"csv"),0===o[n].indexOf("$")&&(o=o.splice(n))})),s={ci:o[0],parentDepth:o[1],childDepth:o[2],namespaces:o[3],excludeClasses:"",dependsOn:o[4]},[2,this.snowConnection.getNestedClasses(s)]):"kubernetes_namespaces"===e.namespace?[2,this.snowConnection.getKubernetesNamespaces()]:"aws_regions"===e.namespace?[2,this.snowConnection.getAWSRegions()]:"generic"===e.namespace?(c=e.rawQuery.split("||"),p=Object(d.getTemplateSrv)().replace(c[0],t.scopedVars,"csv"),m=Object(d.getTemplateSrv)().replace(c[1],t.scopedVars,"csv"),f=Object(d.getTemplateSrv)().replace(c[2],t.scopedVars,"csv"),y=Object(d.getTemplateSrv)().replace(c[3],t.scopedVars,"csv")||"",[2,this.snowConnection.getGenericVariable(p,m,f,y)]):[2])}))}))},t.prototype.query=function(e){return o(this,void 0,Promise,(function(){var t,n,r,l,i=this;return u(this,(function(o){return t=e.range,n=t.from.valueOf(),r=t.to.valueOf(),"Topology"===e.targets[0].selectedQueryCategory.value?[2,this.snowConnection.getTopologyFrame(e.targets[0],n,r,e)]:(l=f.a.map(e.targets,(function(t){if(t.hide)return[];var a=f.a.cloneDeep(t);switch(p()(a,y).selectedQueryCategory.value){case"Metrics":return i.snowConnection.getMetricsFrames(a,n,r,e);case"Alerts":return i.snowConnection.getTextFrames(a,n,r,e,"Alerts");case"Topology":return i.snowConnection.getTopology(a,n,r,e);case"Admin":return i.snowConnection.getTextFrames(a,n,r,e,"Admin");case"CI_Summary":return i.snowConnection.getTextFrames(a,n,r,e,"CI_Summary");case"Changes":return i.snowConnection.getTextFrames(a,n,r,e,"Changes");case"Agents":return i.snowConnection.getTextFrames(a,n,r,e,"Agents");case"Live_Agent_Data":return i.snowConnection.getLiveACCData(a,e);case"Generic":return i.snowConnection.getTextFrames(a,n,r,e,"Generic");case"Database_Views":return i.snowConnection.getTextFrames(a,n,r,e,"Database_Views");case"Row_Count":return i.snowConnection.getRowCount(a,e);case"Aggregate":return i.snowConnection.getAggregateQuery(a,e);case"Geohash_Map":return i.snowConnection.getGeohashMap(a,e);default:return[]}})),[2,Promise.all(f.a.flatten(l)).then(f.a.flatten).then((function(t){return{data:t,state:a.LoadingState.Done,key:e.requestId}}))])}))}))},t.prototype.testDatasource=function(){return this.snowConnection.apiClient.request({url:"/",method:"GET"}).then((function(e){return 200===e.status?{status:"success",message:"Data source connection is successful",title:"Success"}:{status:"error",message:"Data source connection failed: "+e.message,title:"Error"}}))},t}(a.DataSourceApi),I=n(0),q=n.n(I),j=n(1),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),t.prototype.render=function(){var e=this.props,t=e.options,n=e.onOptionsChange;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.DataSourceHttpSettings,{defaultUrl:"https://<instance_name>.service-now.com",dataSourceConfig:t,showAccessOptions:!0,onChange:n}))},t}(I.PureComponent),M=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Service",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedServiceList",{label:e,value:e})},onChange:function(e){return a("selectedServiceList",e)}}))))},N=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"CI",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isMulti:!0,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedSourceList",{label:e,value:e})},onChange:function(e){return a("selectedSourceList",e)}}))))},L=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Resource ID",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedMetricTypeList",{label:e,value:e})},onChange:function(e){return a("selectedMetricTypeList",e)}}))))},P=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Metric Name",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedMetricNameList",{label:e,value:e})},onChange:function(e){return a("selectedMetricNameList",e)}}))))},R=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Anomaly",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isClearable:!0,onChange:function(e){return a("selectedMetricAnomalyList",e)}}))))},D=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Sysparam Query",labelWidth:20},q.a.createElement(j.Input,{name:"sysparam_query",css:null,width:20,defaultValue:n,onBlur:function(e){return t("sysparam_query",e.target.value)}}))))},G=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Alert Type Filter",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,onChange:function(e){return a("selectedAlertTypeList",e)}}))))},k=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Alert State Filter",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,onChange:function(e){return a("selectedAlertStateList",e)}}))))},W=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Change Type Filter",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,onChange:function(e){return a("selectedChangeTypeList",e)}}))))},B=function(e){var t=e.options,n=e.value,a=e.updateQuery,r=e.dependsOptions,l=e.dependsValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Starting Point",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedServiceList",{label:e,value:e})},onChange:function(e){return a("selectedServiceList",e)}})),q.a.createElement(j.InlineField,{label:"Depends On Filter",labelWidth:20},q.a.createElement(j.Select,{width:20,options:r,value:l,defaultValue:l,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedTopologyDependsOnFilter",{label:e,value:e})},onChange:function(e){return a("selectedTopologyDependsOnFilter",e)}}))))},U=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Parent Depth",labelWidth:20},q.a.createElement(j.Input,{name:"parent_depth",css:null,width:20,defaultValue:n,onBlur:function(e){return t("topology_parent_depth",e.target.value)}}))))},$=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Child Depth",labelWidth:20},q.a.createElement(j.Input,{name:"child_depth",css:null,width:20,defaultValue:n,onBlur:function(e){return t("topology_child_depth",e.target.value)}}))))},z=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Included Namespaces",labelWidth:20},q.a.createElement(j.Input,{name:"namespaces",css:null,width:20,defaultValue:n,onBlur:function(e){return t("topology_namespaces",e.target.value)}}))))},J=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Excluded Classes",labelWidth:20},q.a.createElement(j.Input,{name:"excluded_classes",css:null,width:20,defaultValue:n,onBlur:function(e){return t("topology_filter",e.target.value)}}))))},K=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Category Option",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,allowCustomValue:!0,onCreateOption:function(e){return a("selectedAdminCategoryList",{label:e,value:e})},onChange:function(e){return a("selectedAdminCategoryList",e)}}))))},H=function(e){var t=e.options,n=e.value,a=e.updateQuery;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Generalized Agent Metric",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,isMulti:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedMetricNameList",{label:e,value:e})},onChange:function(e){return a("selectedMetricNameList",e)}}))))},X=function(e){var t=e.typeOptions,n=e.typeValue,a=e.updateQuery,r=e.options,l=e.value;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Agent Filter",labelWidth:20},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,allowCustomValue:!0,onCreateOption:function(e){return a("selectedAgentFilterType",{label:e,value:e})},onChange:function(e){return a("selectedAgentFilterType",e)}})),q.a.createElement(j.InlineField,null,q.a.createElement(j.Select,{width:20,options:r,value:l,defaultValue:l,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedAgentFilter",{label:e,value:e})},onChange:function(e){return a("selectedAgentFilter",e)}}))))},Y=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Osquery",labelWidth:20},q.a.createElement(j.Input,{name:"osquery",css:null,width:20,defaultValue:n,onBlur:function(e){return t("live_osquery",e.target.value)}}))))},Z=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Table Name",labelWidth:20},q.a.createElement(j.Input,{name:"table_name",css:null,width:20,defaultValue:n,onBlur:function(e){return t("tableName",e.target.value)}}))))},ee=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Table Columns",labelWidth:20},q.a.createElement(j.Input,{name:"table_columns",css:null,width:20,defaultValue:n,onBlur:function(e){return t("tableColumns",e.target.value)}}))))},te=function(e){var t=e.updateQuery,n=e.defaultValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Group By",labelWidth:20},q.a.createElement(j.Input,{name:"group_by",css:null,width:20,defaultValue:n,onBlur:function(e){return t("groupBy",e.target.value)}}))))},ne=function(e){var t=e.options,n=e.value,a=e.updateQuery,r=e.defaultColumnValue;return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Aggregate Function",labelWidth:20,tooltip:"Choose your aggregation function then the column to run this function on"},q.a.createElement(j.Select,{width:20,options:t,value:n,defaultValue:n,isSearchable:!0,isClearable:!0,backspaceRemovesValue:!0,allowCustomValue:!0,onCreateOption:function(e){return a("selectedAggregateType",{label:e,value:e})},onChange:function(e){return a("selectedAggregateType",e)}})),q.a.createElement(j.InlineField,null,q.a.createElement(j.Input,{name:"aggregate_column",css:null,width:20,defaultValue:r,onBlur:function(e){return a("aggregateColumn",e.target.value)}}))))},ae=function(e){var t,n=e.query,a=e.onChange,r=e.datasource,l=Object(m.defaults)(n,y),c=s(Object(I.useState)([]),2),p=c[0],d=c[1],f=s(Object(I.useState)([]),2),v=f[0],h=f[1],g=s(Object(I.useState)([]),2),b=g[0],C=g[1],T=s(Object(I.useState)([]),2),w=T[0],E=T[1],O=r.snowConnection.getMetricAnomalyOptions(),S=r.snowConnection.getAlertTypeOptions(),_=r.snowConnection.getAlertStateOptions(),V=r.snowConnection.getChangeTypeOptions(),F=r.snowConnection.getAdminQueryOptions(),A=r.snowConnection.getAgentFilterTypeOptions(),x=r.snowConnection.getAgentMetricOptions(),Q=r.snowConnection.getAggregateTypeOptions();function ae(e,t){return e.label.toLowerCase()<t.label.toLowerCase()?-1:e.label.toLowerCase()>t.label.toLowerCase()?1:0}Object(I.useEffect)((function(){o(void 0,void 0,void 0,(function(){var e,t,n,a,i,o,s,c,p,m,f,y,v;return u(this,(function(u){switch(u.label){case 0:return[4,r.snowConnection.getServices("")];case 1:return e=u.sent(),t=[],e.map((function(e){t.some((function(t){return t.value===e.value}))||t.push({label:e.text,value:e.value})})),t.sort(ae),d(t),n=[],a=null!==(v=t[0].value)&&void 0!==v?v:"",void 0!==l.selectedServiceList&&l.selectedServiceList&&(a=l.selectedServiceList.value),[4,le()];case 2:return i=u.sent(),[4,r.snowConnection.getCIs("",a)];case 3:if((o=u.sent()).length>0&&o.map((function(e){n.some((function(t){return t.value===e.value}))||n.push({label:e.text,value:e.value})})),n.sort(ae),h(n),s=[],c=[{label:"*",value:"*"}],p=[],m=[{label:"*",value:"*"}],f=[],void 0!==l.selectedSourceList&&l.selectedSourceList.length>0)for(l.selectedSourceList.map((function(e){s.push(e.label)})),y=0;y<i.fields[0].values.buffer.length;y++)s.includes(i.fields[3].values.buffer[y])&&(p.includes(i.fields[4].values.buffer[y])||""===i.fields[4].values.buffer[y]||(p.push(i.fields[4].values.buffer[y]),c.push({label:i.fields[4].values.buffer[y],value:i.fields[4].values.buffer[y]})),f.includes(i.fields[2].values.buffer[y])||""===i.fields[2].values.buffer[y]||(f.push(i.fields[2].values.buffer[y]),m.push({label:i.fields[2].values.buffer[y],value:i.fields[2].values.buffer[y]})));return c.sort(ae),C(c),m.sort(ae),E(m),[2]}}))}))}),[l]);var re=function(e,t){var n;a(i(i({},l),((n={})[e]=t,n)))},le=function(){return o(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,r.snowConnection.getMetricsDefinition("",0,0,"")];case 1:return[2,e.sent()];case 2:return[2,void 0]}}))}))},ie={Metrics:{title:"Metrics",description:"Get Timeseries metrics",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(M,{options:p,value:l.selectedServiceList,updateQuery:re}),q.a.createElement(N,{options:v,value:l.selectedSourceList,updateQuery:re}),q.a.createElement(L,{options:b,value:l.selectedMetricTypeList,updateQuery:re}),q.a.createElement(P,{options:w,value:l.selectedMetricNameList,updateQuery:re}),q.a.createElement(R,{options:O,value:l.selectedMetricAnomalyList,updateQuery:re}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Alerts:{title:"Alerts",description:"Get Alerts",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(M,{options:p,value:l.selectedServiceList,updateQuery:re}),q.a.createElement(N,{options:v,value:l.selectedSourceList,updateQuery:re}),q.a.createElement(G,{options:S,value:l.selectedAlertTypeList,updateQuery:re}),q.a.createElement(k,{options:_,value:l.selectedAlertStateList,updateQuery:re}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Changes:{title:"Changes",description:"Get Changes",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(M,{options:p,value:l.selectedServiceList,updateQuery:re}),q.a.createElement(N,{options:v,value:l.selectedSourceList,updateQuery:re}),q.a.createElement(W,{options:V,value:l.selectedChangeTypeList,updateQuery:re}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Topology:{title:"Topology",description:"Get Topology",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(B,{options:p,value:l.selectedServiceList,updateQuery:re,dependsOptions:O,dependsValue:l.selectedTopologyDependsOnFilter}),q.a.createElement(U,{updateQuery:re,defaultValue:l.topology_parent_depth}),q.a.createElement($,{updateQuery:re,defaultValue:l.topology_child_depth}),q.a.createElement(z,{updateQuery:re,defaultValue:l.topology_namespaces}),q.a.createElement(J,{updateQuery:re,defaultValue:l.topology_filter}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Admin:{title:"Admin",description:"Definitions and Admin Queries",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(K,{options:F,value:l.selectedAdminCategoryList,updateQuery:re}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},CI_Summary:{title:"CI Summary",description:"CI Summary",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(M,{options:p,value:l.selectedServiceList,updateQuery:re}),q.a.createElement(N,{options:v,value:l.selectedSourceList,updateQuery:re}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Agents:{title:"Agents",description:"Get Agent information",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(H,{updateQuery:re,value:l.selectedMetricNameList,options:x}),q.a.createElement(X,{typeOptions:A,typeValue:l.selectedAgentFilterType,updateQuery:re,options:v,value:l.selectedAgentFilter}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Live_Agent_Data:{title:"Live Agent Data",description:"Get Live Data from your ACC Agents",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(Y,{updateQuery:re,defaultValue:l.live_osquery}))},Generic:{title:"Generic",description:"Get data from any table",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(Z,{updateQuery:re,defaultValue:l.tableName}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Database_Views:{title:"Database Views",description:"Get data from Database View tables",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(Z,{updateQuery:re,defaultValue:l.tableName}),q.a.createElement(ee,{updateQuery:re,defaultValue:l.tableColumns}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Row_Count:{title:"Row Count",description:"Get row count from query",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(Z,{updateQuery:re,defaultValue:l.tableName}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Aggregate:{title:"Aggregate",description:"Group by and apply aggregate functions to table data",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(Z,{updateQuery:re,defaultValue:l.tableName}),q.a.createElement(te,{updateQuery:re,defaultValue:l.groupBy}),q.a.createElement(ne,{options:Q,value:l.selectedAggregateType,updateQuery:re,defaultColumnValue:l.aggregateColumn}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))},Geohash_Map:{title:"GeoHash Map",description:"Get map data from AWS or Azure",content:q.a.createElement(q.a.Fragment,null,q.a.createElement(Z,{updateQuery:re,defaultValue:l.tableName}),q.a.createElement(te,{updateQuery:re,defaultValue:l.groupBy}),q.a.createElement(D,{updateQuery:re,defaultValue:l.sysparam_query}))}};return q.a.createElement(q.a.Fragment,null,q.a.createElement(j.InlineFieldRow,null,q.a.createElement(j.InlineField,{label:"Query Category",labelWidth:20},q.a.createElement(j.Select,{options:function(){var e=[];for(var t in ie){var n=ie[t];e.push({label:n.title,value:t,description:n.description})}return e}(),value:l.selectedQueryCategory,onChange:function(e){re("selectedQueryCategory",e)},width:20}))),ie[null!==(t=l.selectedQueryCategory.value)&&void 0!==t?t:""].content)};n.d(t,"plugin",(function(){return re}));var re=new a.DataSourcePlugin(x).setConfigEditor(Q).setQueryEditor((function(e){return q.a.createElement(ae,i({},e))})).setVariableQueryEditor((function(e){var t=e.onChange,n=e.query,a=s(Object(I.useState)(n),2),r=a[0],l=a[1],o=function(){t(r,r.rawQuery+" ("+r.namespace+")")},u=function(e){var t;return l(i(i({},r),((t={})[e.currentTarget.name]=e.currentTarget.value,t)))};return q.a.createElement(q.a.Fragment,null,q.a.createElement("div",{className:"gf-form"},q.a.createElement("span",{className:"gf-form-label width-10"},"Namespace"),q.a.createElement("input",{name:"namespace",className:"gf-form-input",onBlur:o,onChange:u,value:r.namespace})),q.a.createElement("div",{className:"gf-form"},q.a.createElement("span",{className:"gf-form-label width-10"},"Query"),q.a.createElement("input",{name:"rawQuery",className:"gf-form-input",onBlur:o,onChange:u,value:r.rawQuery})))}))}])}));
//# sourceMappingURL=module.js.map